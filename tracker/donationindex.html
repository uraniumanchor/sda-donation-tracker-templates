{% extends profile.prepend|add:"tracker/index.html" %}
{% load donation_tags %}
{% load i18n %}

{% block title %}{% trans "Donation Index" %} -- {{ dbtitle|title }}{% endblock %}

{% block content %}
	<div class="title">
		<b>{% trans "Event" %}:</b> {{ dbtitle|title }} 
		<b>{% trans "Donation Index" %} {% trans "Total" %}:</b> {{ agg.amount__sum|money }} ({{ agg.amount__count }})
		<b>{% trans "Max/Avg Donation:</b> {{ agg.amount__max|money }}/{{ agg.amount__avg|money }}
	</div>
	<table>
		<tr class="header">
			<td>{% trans "Name" %}{% sort "name" %}</td>
			{% if emails %}<td>{% trans "Email" %}</td>{% endif %}
			<td>{% trans "Time Received" %}{% sort "time" %}</td>
			<td>{% trans "Amount" %}{% sort "amount" %}</td>
			{% if emails %}<td>{% trans "Source" %}</td>{% endif %}
			<td>{% trans "Comment" %}</td>
		</tr>
	{% for donation in donations %}
		<tr>
			<td><a href="{% url tracker.views.donor db=db id=donation.donorId %}">
				{% if usernames %}{{ donation.donorId__lastName }}{% else %}{{ donation.donorId__lastName|slice:":1" }}...{% endif %}, {{ donation.donorId__firstName }}
			</a></td>
			{% if emails %}<td><a href="mailto:{{ donation.donorId__email }}">{{ donation.donorId__email }}</a></td>{% endif %}
			<td>{{ donation.timeReceived }}</td>
			<td><a href="{% url tracker.views.donation db=db id=donation.donationId %}">{{ donation.amount|money }}</a></td>
			{% if emails %}<td>{{ donation.domain|title }}</td>{% endif %}
			<td>{% if donation.comment|length %}{% trans "Yes" %}{% else %}{% trans "No" %}{% endif %}</td>
		</tr>
	{% endfor %}
	</table>
	{% include profile.prepend|add:"tracker/navfooter.html" %}
{% endblock %}