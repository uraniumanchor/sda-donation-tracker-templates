{% extends profile.prepend|add:"tracker/index.html" %}
{% load donation_tags %}

{% block title %}Choice Index -- {{ dbtitle|title }}{% endblock %}

{% block content %}
	<div class="title">
		<b>Event:</b> {{ dbtitle|title }} <b>Choice Index Total:</b> {{ agg.amount__sum|money }}
	</div>
	<table>
		<tr class="header"><td>Game</td><td>Choice</td><td>Option</td><td>Amount</td></tr>
	{% for choice in choices %}
		{% ifchanged choice.speedRun__name %}{% if forloop.counter > 1 %}
		<tr class="header"><td colspan="4"></td></tr>
		{% endif %}{% endifchanged %}
		<tr>
			<td><a href="{% url tracker.views.game db=db id=choice.speedRun %}">{{ choice.speedRun__name|title }}</a></td>
			<td><a href="{% url tracker.views.choice db=db id=choice.choiceId %}">{{ choice.name|title }}</a></td>
			<td><a href="{% url tracker.views.choiceoption db=db id=choice.choiceoption %}">{{ choice.choiceoption__name }}</a></td>
			<td>{{ choice.choiceoption__choicebid__amount__sum|money }} ({{ choice.choiceoption__choicebid__count }})</td>
		</tr>
	{% endfor %}
	</table>
	{% if db %}
	<p><a href="{% url tracker.views.index db=db %}">Back to {{ dbtitle|title }} Index</a></p>
	{% endif %}
	<p><a href="{% url tracker.views.index %}">Back to Main Index</a></p>
{% endblock %}