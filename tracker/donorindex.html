{% extends "tracker/index.html" %}
{% load donation_tags %}

{% block title %}Donor Index -- {{ dbtitle|title }}{% endblock %}

{% block content %}
	<div class="title">
		<b>Event:</b> {{ dbtitle|title }} <b>Donor Index</b>
	</div>
	<table>
		<tr class="header">
			<td>Name{% sort "name" %}</td>
			{% if emails %}<td>Email</td>{% endif %}
			<td>Alias</td>
			<td>Total Donations{% sort "total" %}</td>
			<td>Max{% sort "max" %}/Avg{% sort "avg" %} Donation</td>
		</tr>
	{% for donor in donors %}
		<tr>
			<td><a href="{% url tracker.views.donor db=db id=donor.donorId %}">
				{% if usernames %}{{ donor.lastName }}{% else %}{{ donor.lastName|slice:":1" }}...{% endif %}, {{ donor.firstName }}
			</a></td>
			{% if emails %}<td><a href="mailto:{{ donor.email }}">{{ donor.email }}</a></td>{% endif %}
			<td>{{ donor.alias }}</td>
			<td>{{ donor.donation__amount__sum|money }} ({{ donor.donation__amount__count }})</td>
			<td>{{ donor.donation__amount__max|money }}/{{ donor.donation__amount__avg|money }}</td>
		</tr>
	{% endfor %}
	</table>
	{% if db %}
	<p><a href="{% url tracker.views.index db=db %}">Back to {{ dbtitle|title }} Index</a></p>
	{% endif %}
	<p><a href="{% url tracker.views.index %}">Back to Main Index</a></p>
{% endblock %}